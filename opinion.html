<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>配置</title>
    <script type="text/javascript">
        document.querySelector('html').style.fontSize = window.screen.width / 20 + 'px';
        // 尺寸更改 重新计算 （测试时使用）
        // window.onresize = function () {
        //     document.querySelector('html').style.fontSize = window.screen.width / 20 + 'px';
        // }
    </script>
    <link rel="stylesheet" href="./css/index.css">
</head>
<body>

    <div class="app-container">
        <div class="opinion">
            <textarea name="text" class="textarea" id="textarea" placeholder="请输入配置地址"></textarea>
            <div class="input-btn">
                <div class="shadow-btn" id="submit">提交</div>
            </div>
        </div>
    </div>
    <div class="bottom-tab">
        <ul>
            <li><a href="./index.html">京北方</a></li>
            <li><a href="./clock.html">恒丰</a></li>
            <li><a class="active">配置</a></li>
        </ul>
    </div>
</body>
</html>
<script src="./lib/jquery-3.3.1.min.js"></script>
<script src="./lib/layer.js"></script>

<script>
    $(function() {
        var text = '';
        $('#submit').on('click', function() {
            text = $('#textarea').val();
            if(!text) {
                return layer.open({
                    content: '请输入配置地址',
                    skin: 'msg',
                    time: 3
                });
            }
            toAjax();
        })

        var loading = null;
        function toAjax() {
            loading = layer.open({type: 2, shadeClose: false})
            $.ajax({
                url: '',
                type: 'post',
                dataType: 'json',
                data: { 'text': text },
                success: function(res) {
                    layer.close(loading);
                    if(res.code == 200) {
                        layer.open({
                            content: '提交成功',
                            btn: '我知道了',
                            yes: function() {
                                window.location.href = './my.html';
                            }
                        });
                    } else {
                        layer.open({
                            content: res.msg,
                            btn: '我知道了'
                        });
                    }
                },
                error: function(e) {
                    layer.close(loading);
                    layer.open({
                        content: '请求失败，请稍后再试！',
                        btn: '我知道了'
                    });
                }
            })
        }
    })
</script>